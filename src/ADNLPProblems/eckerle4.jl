export eckerle4

function eckerle4(; use_nls::Bool = false, kwargs...)
  model = use_nls ? :nls : :nlp
  return eckerle4(Val(model); kwargs...)
end

function eckerle4(
  ::Val{:nlp};
  n::Int = default_nvar,
  type::Val{T} = Val(Float64),
  kwargs...,
) where {T}
y = Rational{Int}[
  0.0001575E0    400.000000E0
  0.0001699E0    405.000000E0
  0.0002350E0    410.000000E0
  0.0003102E0    415.000000E0
  0.0004917E0    420.000000E0
  0.0008710E0    425.000000E0
  0.0017418E0    430.000000E0
  0.0046400E0    435.000000E0
  0.0065895E0    436.500000E0
  0.0097302E0    438.000000E0
  0.0149002E0    439.500000E0
  0.0237310E0    441.000000E0
  0.0401683E0    442.500000E0
  0.0712559E0    444.000000E0
  0.1264458E0    445.500000E0
  0.2073413E0    447.000000E0
  0.2902366E0    448.500000E0
  0.3445623E0    450.000000E0
  0.3698049E0    451.500000E0
  0.3668534E0    453.000000E0
  0.3106727E0    454.500000E0
  0.2078154E0    456.000000E0
  0.1164354E0    457.500000E0
  0.0616764E0    459.000000E0
  0.0337200E0    460.500000E0
  0.0194023E0    462.000000E0
  0.0117831E0    463.500000E0
  0.0074357E0    465.000000E0
  0.0022732E0    470.000000E0
  0.0008800E0    475.000000E0
  0.0004579E0    480.000000E0
  0.0002345E0    485.000000E0
  0.0001586E0    490.000000E0
  0.0001143E0    495.000000E0
  0.0000710E0    500.000000E0
]
  function f(x; y = y)
    m = 35
    return 1 // 2 * sum((y[i, 1] - ( x[1] / x[2] * exp(-1 // 2*((y[i, 2] - x[3]) / x[2])^2) ))^2 for i = 1:35)
  end
  x0 = T[1, 10, 500]
  return ADNLPModels.ADNLPModel(f, x0, name = "eckerle4"; kwargs...)
end

function eckerle4(
  ::Val{:nls};
  n::Int = default_nvar,
  type::Val{T} = Val(Float64),
  kwargs...,
) where {T}
y = Rational{Int}[
  0.0001575E0    400.000000E0
  0.0001699E0    405.000000E0
  0.0002350E0    410.000000E0
  0.0003102E0    415.000000E0
  0.0004917E0    420.000000E0
  0.0008710E0    425.000000E0
  0.0017418E0    430.000000E0
  0.0046400E0    435.000000E0
  0.0065895E0    436.500000E0
  0.0097302E0    438.000000E0
  0.0149002E0    439.500000E0
  0.0237310E0    441.000000E0
  0.0401683E0    442.500000E0
  0.0712559E0    444.000000E0
  0.1264458E0    445.500000E0
  0.2073413E0    447.000000E0
  0.2902366E0    448.500000E0
  0.3445623E0    450.000000E0
  0.3698049E0    451.500000E0
  0.3668534E0    453.000000E0
  0.3106727E0    454.500000E0
  0.2078154E0    456.000000E0
  0.1164354E0    457.500000E0
  0.0616764E0    459.000000E0
  0.0337200E0    460.500000E0
  0.0194023E0    462.000000E0
  0.0117831E0    463.500000E0
  0.0074357E0    465.000000E0
  0.0022732E0    470.000000E0
  0.0008800E0    475.000000E0
  0.0004579E0    480.000000E0
  0.0002345E0    485.000000E0
  0.0001586E0    490.000000E0
  0.0001143E0    495.000000E0
  0.0000710E0    500.000000E0
]
  function F!(r, x)
    m = 35
    for i = 1:m
      r[i] = y[i, 1] - ( x[1] / x[2] * exp(-1 // 2*((y[i, 2] - x[3]) / x[2])^2) )
    end
    return r
  end
  x0 = T[1, 10, 500]
  return ADNLPModels.ADNLSModel!(F!, x0, 35, name = "eckerle4-nls"; kwargs...)
end
